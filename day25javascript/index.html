<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <title>DASHBOARD</title>
  </head>
  <body class="bg-dark">
<div class="navber sticky-top">
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
      <a class="navbar-brand" href="#"><img src="./assets/12.PNG" alt="img" width="150px"></a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
          <li class="nav-item fw-bold fs-5 me-5">
            <a class="nav-link text-dark bg-info border border-5 rounded-pill" href="./login.html">LogIn</a>
          </li>
          <li class="nav-item me-5  fw-bold fs-5 ">
            <a class="nav-link text-dark bg-info border border-5 rounded-pill" href="./signup.html">SignUp</a>
          </li>
      </div>
    </div>
  </nav>
</div>



    <div class="container">
      <button
        type="button"
        class="btn btn-primary mt-5 mb-3 fs-4"
        data-bs-toggle="modal"
        data-bs-target="#exampleModal">
        Add Product
      </button>

      <div id="container"></div>
      <!-- Modal -->
      <!--Add Product Modal -->
      <div
        class="modal fade"
        id="exampleModal"
        tabindex="-1"
        aria-labelledby="exampleModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">
                Add Product Form
              </h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <div class="form-floating mb-3">
                <input
                  type="text"
                  class="form-control"
                  id="imageURL"
                  placeholder="Enter image url here"
                />
                <label for="imageURL">Product Image URL</label>
              </div>
              <div class="form-floating mb-3">
                <input
                  type="text"
                  class="form-control"
                  id="title"
                  placeholder="Product Title"
                />
                <label for="title">Product Title</label>
              </div>
              <div class="row mb-3">
                <div class="col-6">
                  <div class="form-floating">
                    <input
                      type="number"
                      class="form-control"
                      id="price"
                      placeholder="Product price"
                    />
                    <label for="price">Product price</label>
                  </div>
                </div>
                <div class="col-6">
                  <div class="form-floating">
                    <input
                      type="text"
                      class="form-control"
                      id="category"
                      placeholder="Product category"
                    />
                    <label for="category">Product category</label>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="form-floating">
                  <textarea
                    class="form-control"
                    placeholder="Product Description"
                    id="description"
                  ></textarea>
                  <label for="description">Description</label>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
                id="closebtn"
              >
                Close
              </button>
              <button
                type="button"
                class="btn btn-primary"
                onclick="addProduct()"
              >
                Add Product
              </button>
            </div>
          </div>
        </div>
      </div>
      <!--View Details Product -->
      <div
        class="modal fade"
        id="viewModal"
        tabindex="-1"
        aria-labelledby="exampleModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">
                View Product Details
              </h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <div class="form-floating mb-3">
                <img id="view-imageURL" width="300" height="300" alt="" />
              </div>
              <div class="form-floating mb-3">
                <input
                  type="text"
                  class="form-control"
                  id="view-title"
                  placeholder="Product Title"
                />
                <label for="title">Product Title</label>
              </div>
              <div class="row mb-3">
                <div class="col-6">
                  <div class="form-floating">
                    <input
                      type="number"
                      class="form-control"
                      id="view-price"
                      placeholder="Product price"
                    />
                    <label for="price">Product price</label>
                  </div>
                </div>
                <div class="col-6">
                  <div class="form-floating">
                    <input
                      type="text"
                      class="form-control"
                      id="view-category"
                      readonly
                      placeholder="Product category"
                    />
                    <label for="category">Product category</label>
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="form-floating">
                  <textarea
                    class="form-control h-100"
                    placeholder="Product Description"
                    id="view-description"
                  ></textarea>
                  <label for="description">Description</label>
                </div>
              </div>
            </div>

            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-info fs-4 p-2"
                data-bs-dismiss="modal"
                id="closebtn"
              >
                Close
              </button>
            </div>
          </div>
        </div>
      </div>
 <!--Edit Product Modal -->
 <div
 class="modal fade"
 id="editModal"
 tabindex="-1"
 aria-labelledby="exampleModalLabel"
 aria-hidden="true"
>
 <div class="modal-dialog">
   <div class="modal-content">
     <div class="modal-header">
       <h5 class="modal-title" id="exampleModalLabel">
         Edit Product Details
       </h5>
       <button
         type="button"
         class="btn-close"
         data-bs-dismiss="modal"
         aria-label="Close"
       ></button>
     </div>
     <div class="modal-body">
       <div class="form-floating mb-3">
         <input
           type="text"
           class="form-control"
           id="edit-imageURL"
           placeholder="Enter image url here"
         />
         <label for="imageURL">Product Image URL</label>
       </div>
       <div class="form-floating mb-3">
         <input
           type="text"
           class="form-control"
           id="edit-title"
           placeholder="Product Title"
         />
         <label for="title">Product Title</label>
       </div>
       <div class="row mb-3">
        <div class="col-6">
          <div class="form-floating">
            <input
              type="number"
              class="form-control"
              id="edit-price"
              placeholder="Product price"
            />
            <label for="price">Product price</label>
          </div>
        </div>
        <div class="col-6">
          <div class="form-floating">
            <input
              type="text"
              class="form-control"
              id="edit-category"
              placeholder="Product category"
            />
            <label for="category">Product category</label>
          </div>
        </div>
      </div>

       <div class="row">
         <div class="form-floating">
           <textarea
             class="form-control"
             placeholder="Product Description"
             id="edit-description"
           ></textarea>
           <label for="description">Description</label>
         </div>
       </div>
     </div>

     <div class="modal-footer">
       <button
         type="button"
         class="btn btn-secondary"
         data-bs-dismiss="modal"
         id="edit-closebtn"
       >
         Close
       </button>
       <button
         type="button"
         class="btn btn-success"
         onclick="editProduct()"
       >
         Edit
       </button>
     </div>
   </div>
 </div>
</div>
</div>
    <script>
   

      let actualProduct = [];
      let productId="";
      const container = document.getElementById("container");
      container.style.display = "flex";
      container.style.flexWrap = "wrap";
      container.style.gap = "70px";
      container.style.marginBottom = "5%";
      const fetchProducts = async () => {
        const resp = await fetch("https://dummyjson.com/products");
        const { products } = await resp.json();
        actualProduct = products;
        newProducts(products);
      };
      const newProducts = (products) => {
        container.innerHTML = "";
        for (let product of products) {
          const card = document.createElement("div");
          card.style.width = "29%";
          card.style.height = "450px";
          card.className = "card d-flex";
          card.style.position="relative";
          card.style.padding="2%"
          const cardHeader = document.createElement("div");
          cardHeader.className = "card-header h-50";
          const image = document.createElement("img");
          image.src = product.thumbnail;
          image.classList = "h-100 w-100 border border-dark";
          cardHeader.append(image);
          card.append(cardHeader);
          const h2 = document.createElement("h2");
          h2.innerText =
            product.title.length > 14
              ? product.title.slice(0, 13) + "..."
              : product.title;
          card.append(h2);

          const p = document.createElement("p");
          p.innerText = product.description;
          p.innerText = product.description.slice(0, 14) + "...";
          card.append(p);

               //  VIEW DETAILS
               const viewButton = document.createElement("button");
          viewButton .innerText = "View Details";
          viewButton .setAttribute("data-bs-toggle", "modal");
          viewButton .setAttribute("data-bs-target", "#viewModal");
          viewButton .classList.add(
            "btn",
            "btn-outline-primary",
            "btn-sm",
            "mb-3",
            "mt-2",
            "col-5",
          );
          viewButton .addEventListener("click", (event) => {
            event.preventDefault();
            document.getElementById("view-imageURL").src = product.thumbnail;
            viewReadonly(document.getElementById("view-title"));
            document.getElementById("view-title").value = product.title;
            viewReadonly(document.getElementById("view-price"));
            document.getElementById("view-price").value=product.price;
            viewReadonly(document.getElementById("view-category"));
            document.getElementById("view-category").value=product.category;
            viewReadonly(document.getElementById("view-description"));
            document.getElementById("view-description").value=product.description;
          });
          card.append(viewButton);
          function viewReadonly(viewdetails) {
            viewdetails.setAttribute("readOnly", "true");
      }
      // console.log(actualProduct)

           // EDITS
          const editbutton = document.createElement("button");
          editbutton.innerText = "Edit";
          editbutton.style.position="absolute"
          editbutton.style.top="69.2%"
          editbutton.style.left="50%"
          editbutton.classList.add(
            "btn",
            "btn-outline-secondary",
            "btn-sm",
            "mb-3",
            "col-5",
            "mt-2",
            "ms-2",
          );
          editbutton.setAttribute("data-bs-toggle", "modal");
          editbutton.setAttribute("data-bs-target", "#editModal");
          editbutton.addEventListener("click", (event) => {
            event.preventDefault();

            productId = product.id;
              // 2nd step ->set actual value of that product
            const imageURL = document.getElementById("edit-imageURL");
            imageURL.value = product.thumbnail;
            const title = document.getElementById("edit-title");
            title.value = product.title;
            const price = document.getElementById("edit-price");
            price.value = product.price;
            const category = document.getElementById("edit-category");
            category.value = product.category;
            const description = document.getElementById("edit-description");
            description.value = product.description;
          });
          card.append(editbutton);


          // DELETE
          const deleteButton = document.createElement("button");
          deleteButton.innerText = "Delete";
          deleteButton.classList.add(
            "btn",
             "btn-outline-danger", 
             "btn-sm",
              "mb-2",
              );
              deleteButton.addEventListener("click", (event) => {
            event.preventDefault();
            const filteredProduct = products.filter((prod) => {
              if (prod.id !== product.id) {
                return true;
              }
              return prod.id !== product.id;
            });
            newProducts(filteredProduct);
          });
          card.append(deleteButton);

          container.append(card);
        }
      };
      fetchProducts();

      // 3rd step of edit(calling function)
      function editProduct() {
        const title = document.getElementById("edit-title").value;
        const description = document.getElementById("edit-description").value;
        const imageURL = document.getElementById("edit-imageURL").value;
        const price = document.getElementById("edit-price").value;
        const category = document.getElementById("edit-category").value;
        const editedFinalData = {
          id: productId,
          title,
          description,
          thumbnail: imageURL,
          category,
          price,
        };

        const editedProductData = actualProduct.map((product) => {
          if (product.id === productId) {
            return editedFinalData;
          } else {
            return product;
          }
          // return product.id === productId ? editedFinalData : product;
        });
        //  actualProduct=editedFinalData;
        newProducts(editedProductData);

        document.getElementById("edit-closebtn").click();
      }

      function addProduct() {
        const imageURL = document.querySelector("#imageURL").value;
        const title = document.querySelector("#title").value;
        const price = document.querySelector("#price").value;
        const category = document.querySelector("#category").value;
        const description = document.querySelector("#description").value;

        const card = document.createElement("div");
        card.style.width = "22%";
        card.style.height = "400px";
        card.className = "card";

        const cardHeader = document.createElement("div");
        cardHeader.className = "card-header h-50";

        const image = document.createElement("img");
        image.src = imageURL;
        image.classList = "h-100 w-100";
        cardHeader.append(image);

        card.append(cardHeader);

        const h2 = document.createElement("h2");
        h2.innerText = title.length > 14 ? title.slice(0, 13) + "..." : title;
        card.append(h2);
        const h3 = document.createElement("h3");
        h3.innerText = price;
        card.append(h3);
        const p1 = document.createElement("p");
        p1.innerText = category;
        card.append(p1);
        const p = document.createElement("p");
        p.innerText = description;
        card.append(p);

        container.append(card);

        let newProduct = {
          id: Date.now(),
          title,
          description,
          price,
          category,
          thumbnail: imageURL,
        };
      
        actualProduct = [newProduct, ...actualProduct];
        newProducts(actualProduct);
        document.getElementById("closebtn").click();
      }
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
  </body>
</html>